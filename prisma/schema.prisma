// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Account {
  Id            String    @id @default(uuid())
  DiscordId     String    @unique
  Username      String
  Discriminator String
  Locale        String    @default("en-US")
  Email         String?   @unique
  Verified      Boolean?  @default(false)
  IsOnAirLinked Boolean?  @default(false)
  IsAdmin       Boolean   @default(false)
  IsEnabled     Boolean   @default(false)
  LastLogin     DateTime?
  CreatedAt     DateTime  @default(now())
  UpdatedAt     DateTime? @updatedAt
  ApprovalToken String?
  ApprovedById  String?
  EmployeeId    String?   @unique
  CompanyId     String?   @unique
  ApprovedAt    DateTime?
  Approvals     Account[] @relation("ApprovedByAccount")
  Company       Company?  @relation("CompanyOwnerAccount")
  Employee      Employee? @relation(fields: [EmployeeId], references: [Id])
  ApprovedBy    Account?  @relation("ApprovedByAccount", fields: [ApprovedById], references: [Id])
  // FerriesCompleted Ferry[]          @relation("FerryCompletedByAccount")
  // VaInvitations    VAInvitation[]
}

model VirtualAirline {
  Id                                     String    @id
  Name                                   String
  AirlineCode                            String    @unique
  ApiKey                                 String?   @unique
  InitalOwnerEquity                      Int?
  PercentDividendsToDistribute           Float?
  LastDividendsDistribution              DateTime?
  ImageName                              String?
  ForceAssignJobsToPilots                Boolean?
  AutomaticallyAssignJobWhenTaken        Boolean?
  AutomaticallyAssignJobWhenLoaded       Boolean?
  RestrictEmployeesUsage                 Boolean?
  RestrictLoadingVAJobsIntoNonVAAircraft Boolean?
  RestrictLoadingNonVAJobsIntoVAAircraft Boolean?
  MemberCount                            Int?
  LastConnection                         DateTime?
  LastReportDate                         DateTime?
  Reputation                             Float?
  CreationDate                           DateTime
  DifficultyLevel                        Int?
  UTCOffsetinHours                       Float?
  Paused                                 Boolean?
  Level                                  Int?
  LevelXP                                Int?
  TransportEmployeeInstant               Boolean?
  TransportPlayerInstant                 Boolean?
  ForceTimeInSimulator                   Boolean?
  UseSmallAirports                       Boolean?
  UseOnlyVanillaAirports                 Boolean?
  EnableSkillTree                        Boolean?
  CheckrideLevel                         Int?
  EnableLandingPenalities                Boolean?
  EnableEmployeesFlightDutyAndSleep      Boolean?
  AircraftRentLevel                      Int?
  EnableCargosAndChartersLoadingTime     Boolean?
  InSurvival                             Boolean?
  PayBonusFactor                         Float?
  EnableSimFailures                      Boolean?
  DisableSeatsConfigCheck                Boolean?
  RealisticSimProcedures                 Boolean?
  TravelTokens                           Int?
  WorldId                                String
  // OwnerId                                String?

  OnAirSyncedAt DateTime?
  CreatedAt     DateTime  @default(now())
  UpdatedAt     DateTime? @updatedAt

  Member    Member[]
  VARoles   VARole[]
  Members   Company[]
  RefreshRequests OnAirRequest[]
  World     World    @relation(fields: [WorldId], references: [Id])
  // Owner         Account?       @relation(fields: [OwnerId], references: [Id])
  // Invitations   VAInvitation[]
  // Notifications Notification[]
}

model Company {
  Id                                 String                @id
  Name                               String
  AirlineCode                        String                @unique
  ApiKey                             String?               @unique
  VirtualAirlineId                   String
  OwnerId                            String?               @unique
  LastConnection                     DateTime?
  LastReportDate                     DateTime?
  Reputation                         Float?
  CreationDate                       DateTime?
  DifficultyLevel                    Int?                  @default(1)
  UTCOffsetinHours                   Int?                  @default(0)
  Paused                             Boolean?              @default(false)
  PausedDate                         DateTime?
  Level                              Int?                  @default(1)
  LevelXP                            Int?                  @default(1000)
  TransportEmployeeInstant           Boolean?              @default(false)
  TransportPlayerInstant             Boolean?              @default(false)
  ForceTimeInSimulator               Boolean?              @default(false)
  UseSmallAirports                   Boolean?              @default(false)
  UseOnlyVanillaAirports             Boolean?              @default(false)
  EnableSkillTree                    Boolean?              @default(false)
  CheckrideLevel                     Int?                  @default(0)
  EnableLandingPenalities            Boolean?              @default(false)
  EnableEmployeesFlightDutyAndSleep  Boolean?              @default(false)
  AircraftRentLevel                  Int?                  @default(0)
  EnableCargosAndChartersLoadingTime Boolean?              @default(false)
  InSurvival                         Boolean?              @default(false)
  PayBonusFactor                     Int?                  @default(0)
  EnableSimFailures                  Boolean?              @default(false)
  DisableSeatsConfigCheck            Boolean?              @default(false)
  RealisticSimProcedures             Boolean?              @default(false)
  TravelTokens                       Int?                  @default(0)
  CurrentBadgeId                     String?
  CurrentBadgeUrl                    String?
  CurrentBadgeName                   String?
  WorldId                            String?
  LastWeeklyManagementsPaymentDate   DateTime?
  OnAirSyncedAt                      DateTime?
  CreatedAt                          DateTime              @default(now())
  UpdatedAt                          DateTime?             @updatedAt
  Owner                              Account?              @relation("CompanyOwnerAccount", fields: [OwnerId], references: [Id])
  VirtualAirline                     VirtualAirline        @relation(fields: [VirtualAirlineId], references: [Id])
  Employees                          Employee[]
  Member                             Member[]
  World                              World?                @relation(fields: [WorldId], references: [Id])
  // Invitations                        VAInvitation[]
  // Notifications                      Notification[]
  // RentalAircraft                     Aircraft[]     @relation("AircraftRentalCompany")
  // OwnedAircraft                      Aircraft[]     @relation("AircraftOwnerCompany")
  // CurrentAicraft                     Aircraft[]     @relation("AircraftCurrentCompany")
  // AssignedCharterJobs                Charter[]      @relation("CharterAssignedToVAMember")
  // AssignedCargoJobs                  Cargo[]        @relation("CargoAssignedToVAMember")
  // Jobs                               Job[]
  // Flight                             Flight[]
}

model World {
  Id        String @id @default(uuid())
  Name      String
  ShortName String @unique

  CreatedAt DateTime  @default(now())
  UpdatedAt DateTime? @updatedAt
  Companies Company[]
  VirtualAirlines VirtualAirline[]
  // Aircraft  Aircraft[]
}

model Employee {
  Id                           String                @id
  Pseudo                       String
  CompanyId                    String
  CurrentAirportId             String?
  HomeAirportId                String?
  FlightHoursTotalBeforeHiring Float?
  FlightHoursInCompany         Float?
  Category                     Int
  Status                       Int
  LastStatusChange             DateTime?
  BirthDate                    DateTime?
  IsOnline                     Boolean               @default(false)
  FlightHoursGrandTotal        Float?
  OnAirSyncedAt                DateTime?
  UpdatedAt                    DateTime?             @updatedAt
  CreatedAt                    DateTime              @default(now())
  Company                      Company               @relation(fields: [CompanyId], references: [Id])
  // Notifications                Notification[]
  Account                      Account?
  CurrentAirport               Airport?              @relation("EmployeeCurrentAirport", fields: [CurrentAirportId], references: [Id])
  HomeAirport                  Airport?              @relation("EmployeeHomeAirport", fields: [HomeAirportId], references: [Id])
}

model Airport {
  Id                                 String                @id
  ICAO                               String                @unique
  IATA                               String?
  DisplayName                        String
  HasNoRunways                       Boolean?              @default(false)
  TimeOffsetInSec                    Int?                  @default(0)
  LocalTimeOpenInHoursSinceMidnight  Float?
  LocalTimeCloseInHoursSinceMidnight Float?
  Name                               String
  State                              String?
  CountryCode                        String?
  CountryName                        String?
  City                               String?
  Latitude                           Float?
  Longitude                          Float?
  Elevation                          Float?
  HasLandRunway                      Boolean?              @default(false)
  HasWaterRunway                     Boolean?              @default(false)
  HasHelipad                         Boolean?              @default(false)
  Size                               Int                   @default(0)
  TransitionAltitude                 Int?
  LastMETARDate                      DateTime?
  IsNotInVanillaFSX                  Boolean?              @default(false)
  IsNotInVanillaP3D                  Boolean?              @default(false)
  IsNotInVanillaXPLANE               Boolean?              @default(false)
  IsNotInVanillaFS2020               Boolean?              @default(false)
  IsClosed                           Boolean?              @default(false)
  IsValid                            Boolean?              @default(false)
  MagVar                             Float?
  IsAddon                            Boolean?              @default(false)
  RandomSeed                         Int?
  LastRandomSeedGeneration           DateTime?
  IsMilitary                         Boolean?              @default(false)
  HasLights                          Boolean?              @default(false)
  AirportSource                      Int
  LastVeryShortRequestDate           DateTime?
  LastSmallTripRequestDate           DateTime?
  LastMediumTripRequestDate          DateTime?
  LastShortHaulRequestDate           DateTime?
  LastMediumHaulRequestDate          DateTime?
  LastLongHaulRequestDate            DateTime?
  UTCTimeOpenInHoursSinceMidnight    Float?
  UTCTimeCloseInHoursSinceMidnight   Float?
  OnAirSyncedAt                      DateTime?
  UpdatedAt                          DateTime?             @updatedAt
  CreatedAt                          DateTime              @default(now())
  EmployeesAtAirport                 Employee[]            @relation("EmployeeCurrentAirport")
  EmployeesHomeAirport               Employee[]            @relation("EmployeeHomeAirport")
  // CurrentAircraft                    Aircraft[] @relation("AircraftCurrentAirport")
  // HomeAircraft                       Aircraft[] @relation("AircraftHomeAirport")
  // DepartingFlights                   Flight[]   @relation("FlightDepartureAirport")
  // ArrivalIntendedFlights             Flight[]   @relation("FlightArrivalIntendedAirport")
  // ArrivalAlternateFlights            Flight[]   @relation("FlightArrivalAlternateAirport")
  // ArrivalActualFlights               Flight[]   @relation("FlightArrivalActualAirport")
  // CurrentCharters                    Charter[]  @relation("CharterCurrentAirport")
  // DepartingCharters                  Charter[]  @relation("CharterDepartureAirport")
  // ArrivingCharters                   Charter[]  @relation("CharterDestinationAirport")
  // CurrentCargo                       Cargo[]    @relation("CargoCurrentAirport")
  // DepartingCargo                     Cargo[]    @relation("CargoDepartureAirport")
  // ArrivingCargo                      Cargo[]    @relation("CargoDestinationAirport")
  // MainJobs                           Job[]      @relation("JobMainAirport")
  // BaseJobs                           Job[]      @relation("JobBaseAirport")
  // FerryDepartures                    Ferry[]    @relation("FerryDepartureAirport")
  // FerryArrivals                      Ferry[]    @relation("FerryArrivalAirport")
}

model VARole {
  Id                                     String         @id
  VAId                                   String
  Name                                   String
  Permission                             Int
  IsDefaultNewRole                       Boolean
  Color                                  String
  PayPercent                             Float          @default(0.00)
  IsHidden                               Boolean
  RestrictLoadingVAJobsIntoNonVAAircraft Boolean
  RestrictLoadingNonVAJobsIntoVAAircraft Boolean
  PayWeekly                              Float          @default(0.00)
  PayPerFlightHour                       Float          @default(0.00)
  OnAirSyncedAt                          DateTime?
  UpdatedAt                              DateTime?      @updatedAt
  CreatedAt                              DateTime       @default(now())
  Members                                Member[]
  VirtualAirline                         VirtualAirline @relation(fields: [VAId], references: [Id])
}

model Member {
  Id                        String                @id
  VaId                      String
  CompanyId                 String
  VARoleId                  String
  TotalCargosTransportedLbs Float                 @default(0.00)
  TotalPAXsTransported      Int                   @default(0)
  TotalEarnedCredits        Float                 @default(0.00)
  TotalSpentCredits         Float                 @default(0.00)
  NumberOfFlights           Int                   @default(0)
  FlightHours               Float                 @default(0.00)
  Color                     String
  AcceptMigration           Boolean               @default(false)
  ReputationImpact          Float                 @default(0.00)
  LastWeeklyPay             DateTime?
  OnAirSyncedAt             DateTime?
  UpdatedAt                 DateTime?             @updatedAt
  CreatedAt                 DateTime?             @default(now())
  Company                   Company               @relation(fields: [CompanyId], references: [Id])
  VARole                    VARole                @relation(fields: [VARoleId], references: [Id])
  VirtualAirline            VirtualAirline        @relation(fields: [VaId], references: [Id])
}

model OnAirRequest {
  Id           String    @id @default(uuid())
  Model        String // model name that is being requested
  RequestDate  DateTime // request datetime to OnAir
  ResponseDate DateTime? // response datetime from OnAir
  ResponseData String? // JSON response from OnAir
  VirtualAirlineId String?
  CreatedAt DateTime @default(now())
  UpdatedAt DateTime? @updatedAt

  VirtualAirline VirtualAirline? @relation(fields: [VirtualAirlineId], references: [Id])
  // Member         Member?         
  // Employee       Employee?       
  // Airport        Airport?        
  // Company        Company?        
}

// model VAInvitation {
//   Id         String    @id
//   VaId       String
//   CompanyId  String
//   AccountId  String
//   IsPending  Boolean   @default(true)
//   Token      String
//   EmailId    String
//   AcceptedAt DateTime?

//   CreatedAt DateTime  @default(now())
//   UpdatedAt DateTime? @updatedAt

//   Va      VirtualAirline @relation(fields: [VaId], references: [Id])
//   Company Company        @relation(fields: [CompanyId], references: [Id])
//   Account Account        @relation(fields: [AccountId], references: [Id])
//   // Email   Email          @relation(fields: [EmailId], references: [Id])
// }
